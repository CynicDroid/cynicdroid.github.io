<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CynicDroid Catalog â€” Neon Pulse</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Kanit:wght@400;600&display=swap" rel="stylesheet">

<!-- Use the modern EmailJS browser bundle -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

<style>
:root{
  --cyan:#00ffff;
  --lime:#aef710;
  --bg:#2e2e2e;
  --card-bg: rgba(0,255,255,0.05);
  --modal-bg: #1a1a1a;
  --text-color: #e0e0e0;
  --neon-shadow: 0 0 12px var(--cyan),0 0 24px var(--lime);
}
*{box-sizing:border-box}
body{font-family:'Kanit',sans-serif;background:var(--bg);color:var(--text-color);margin:0;overflow-x:hidden;display:flex;min-height:100vh;scroll-behavior:smooth;}
.sidebar{width:240px;background:var(--bg);border-right:2px solid var(--cyan);box-shadow: var(--neon-shadow);position:fixed;top:0;left:0;bottom:0;padding:1rem;display:flex;flex-direction:column;align-items:center;z-index:20;overflow-y:auto;}
.cynicdroid-brand{font-family:'Orbitron',sans-serif;font-size:1.6rem;font-weight:700;color:var(--cyan);text-shadow:0 0 12px var(--cyan),0 0 20px var(--lime);margin-bottom:1rem;}
.category-filter-vertical{display:flex;flex-direction:column;gap:0.6rem;width:100%;margin-top:0.5rem;}
.category-filter-vertical button{background:transparent;border:1px solid var(--cyan);color: var(--cyan);padding:0.6rem 1rem;border-radius:0.5rem;cursor:pointer;transition:0.2s;text-align:left;}
.category-filter-vertical button.active,
.category-filter-vertical button:hover{background:var(--cyan);color:#000;box-shadow: var(--neon-shadow);}
.topbar{position:fixed;right:1rem;top:1rem;z-index:60;display:flex;gap:0.75rem;align-items:center;}
.cart-icon{position:relative;width:48px;height:48px;display:flex;align-items:center;justify-content:center;border-radius:10px;background:linear-gradient(90deg,var(--cyan),var(--lime));color:#000;box-shadow: var(--neon-shadow);cursor:pointer;font-weight:700;}
.cart-count{position:absolute;top:-8px;right:-8px;background:var(--bg);border:2px solid var(--cyan);color:var(--cyan);padding:2px 6px;border-radius:999px;font-size:0.8rem;box-shadow:0 0 8px var(--cyan);}
.main-content{margin-left:260px;flex-grow:1;padding:2rem;padding-top:3.2rem;}
header{text-align:center;margin-bottom:1rem;}
h1{font-family:'Orbitron',sans-serif;color:var(--cyan);text-shadow:0 0 8px var(--cyan),0 0 18px var(--lime);margin:0;}
.controls{display:flex;gap:1rem;align-items:center;justify-content:flex-start;margin:1rem 0 1.5rem 0;flex-wrap:wrap;}
#searchInput, #sortSelect{padding:0.65rem 0.9rem;border-radius:10px;border:1px solid var(--cyan);background:transparent;color:var(--text-color);min-width:220px;}
#sortSelect{ font-family:'Orbitron',sans-serif; color:var(--cyan); }
.category{ padding:0.5rem 0;}
.category h2{ margin:0 0 0.6rem 0; font-size:1.2rem;}
.grid{ display:grid; gap:1.2rem; grid-template-columns:repeat(auto-fit,minmax(220px,1fr));}
.card{ background: var(--card-bg); border:1px solid var(--cyan); border-radius:1rem; box-shadow: var(--neon-shadow); overflow:hidden; display:flex; flex-direction:column; transition:0.3s; cursor:pointer; position:relative; }
.card:hover{ transform:scale(1.03); box-shadow:0 0 20px var(--cyan),0 0 40px var(--lime); }
.card img{ width:100%; height:170px; object-fit:cover;}
.card-content{ padding:0.9rem; flex-grow:1; display:flex; flex-direction:column;}
.card-content h3{ font-family:'Orbitron',sans-serif; font-size:1.05rem; margin:0 0 0.5rem 0; color:var(--cyan); }
.card-content p{ flex-grow:1; margin:0 0 0.6rem 0; font-size:0.95rem; color:#cfd8dc;}
.card-content .price{ font-weight:700; color:var(--lime); margin-bottom:0.5rem;}
.pagination{ display:flex; gap:0.5rem; margin-top:0.6rem; justify-content:center; flex-wrap:wrap;}
.pagination button{ background:transparent; border:1px solid var(--cyan); color:var(--cyan); padding:0.4rem 0.7rem; border-radius:0.5rem; cursor:pointer; transition:0.2s;}
.pagination button.active, .pagination button:hover{ background:var(--cyan); color:#000; box-shadow:0 0 12px var(--cyan); }
@keyframes neonPulse { 0% { box-shadow: 0 0 12px var(--cyan),0 0 24px var(--lime); transform: scale(1); } 50% { box-shadow: 0 0 20px var(--lime),0 0 36px var(--cyan); transform: scale(1.05); } 100% { box-shadow: 0 0 12px var(--cyan),0 0 24px var(--lime); transform: scale(1); } }
.btn-neon{ background:linear-gradient(90deg,var(--cyan),var(--lime)); color:#000; font-weight:600; text-transform:uppercase; box-shadow: var(--neon-shadow); transition:0.18s; text-align:center; cursor:pointer; padding:0.5rem 0.6rem; border-radius:8px; border:none;}
.btn-outline{ background:transparent; border:1px solid var(--cyan); color:var(--cyan); padding:0.45rem 0.6rem; border-radius:8px; cursor:pointer;}
.btn-outline:hover{ background:var(--cyan); color:#000; box-shadow:0 0 12px var(--cyan);}
.modal{ position:fixed; top:0; left:0; width:100%; height:100%; display:none; justify-content:center; align-items:center; z-index:70; }
.modal-content{ background: var(--modal-bg); border:2px solid var(--cyan); border-radius:1rem; padding:1.25rem; width:92%; max-width:720px; box-shadow:0 0 20px var(--cyan),0 0 40px var(--lime); position:relative;}
.small-modal{ max-width:420px; }
.modal .closeModal{ position:absolute; top:0.6rem; right:0.8rem; font-size:1.2rem; color:var(--cyan); cursor:pointer; }
.modal .closeModal:hover{ color:var(--lime); }
#previewModal img, #checkoutModal img{ width:100%; border-radius:0.5rem; margin-bottom:0.9rem; box-shadow:0 0 10px var(--cyan); }
#previewModal .preview-grid{ display:grid; grid-template-columns:1fr 1fr; gap:1rem; align-items:start; }
#previewModal h3, #checkoutModal h3{ margin:0 0 0.4rem 0; color:var(--cyan); font-family:'Orbitron',sans-serif; }
#previewModal p, #checkoutModal p{ color:#cfd8dc; }
.cart-items{ max-height:320px; overflow:auto; margin-bottom:0.8rem; display:flex; flex-direction:column; gap:0.6rem; padding-right:0.25rem; }
.cart-item{ display:flex; gap:0.75rem; align-items:center; border-radius:8px; padding:0.5rem; background:rgba(0,255,255,0.02); border:1px solid rgba(0,255,255,0.04); }
.cart-item img{ width:64px; height:48px; object-fit:cover; border-radius:6px; }
.cart-item .meta{ flex:1; }
.qty-controls{ display:flex; gap:0.4rem; align-items:center; }
.qty-controls button{ background:transparent; border:1px solid var(--cyan); color:var(--cyan); width:28px; height:28px; border-radius:6px; cursor:pointer; }
.cart-totals{ display:flex; justify-content:space-between; align-items:center; gap:1rem; margin-top:0.6rem; padding-top:0.6rem; border-top:1px dashed rgba(174,247,16,0.08); }
.cart-empty{ text-align:center; color:#9aa7ab; padding:1rem 0; }
.confetti-piece{ position:absolute; width:8px; height:8px; background:linear-gradient(45deg,#00ffff,#aef710); opacity:0.9; pointer-events:none; z-index:100; animation: fall 2s linear forwards; }
@keyframes fall{0%{transform:translateY(0) rotate(0deg);}100%{transform:translateY(100vh) rotate(360deg);} }
@media (max-width:900px){
  .sidebar{ position:relative; width:100%; height:auto; display:flex; flex-direction:row; padding:0.5rem; overflow:auto; border-right: none; border-bottom: 2px solid var(--cyan); }
  .category-filter-vertical{ flex-direction:row; gap:0.5rem; padding:0 0.5rem; }
  .main-content{ margin-left:0; padding-top:1.6rem; }
  #previewModal .preview-grid{ grid-template-columns:1fr; }
}
</style>
</head>
<body>

<aside class="sidebar">
  <a href="index.html" class="cynicdroid-brand hover:scale-105 transition-transform duration-200">
    <span class="font-[Orbitron] font-bold text-[1.7rem] tracking-[2px]"
      style="color:#00ffff; text-shadow:0 0 12px #00ffff, 0 0 24px #aef710;">
      CynicDroid
    </span>
  </a>
  <div class="category-filter-vertical" id="categoryFilter"></div>
</aside>

<style>
.cynicdroid-brand:hover span {
  animation: neonPulse 1.2s infinite alternate, neonFlicker 0.18s 3 ease-in-out;
  transform: scale(1.05);
}

@keyframes neonPulse {
  0% { text-shadow: 0 0 12px #00ffff, 0 0 24px #aef710; }
  50% { text-shadow: 0 0 20px #aef710, 0 0 40px #00ffff; }
  100% { text-shadow: 0 0 12px #00ffff, 0 0 24px #aef710; }
}

@keyframes neonFlicker {
  0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% { opacity: 1; }
  20%, 22%, 24%, 55% { opacity: 0.4; }
}
</style>


<div class="topbar">
  <div id="cartBtn" class="cart-icon" title="Open Cart">ðŸ›’
    <div id="cartCount" class="cart-count">0</div>
  </div>
</div>

<div class="main-content">
  <header><h1>Product Catalog</h1></header>
  <div class="controls">
    <input id="searchInput" placeholder="Search products..." />
    <select id="sortSelect">
      <option value="default">Sort: Default</option>
      <option value="priceLow">Price: Low â†’ High</option>
      <option value="priceHigh">Price: High â†’ Low</option>
      <option value="nameAZ">Name: A â†’ Z</option>
      <option value="nameZA">Name: Z â†’ A</option>
    </select>
    <div style="flex:1"></div>
  </div>
  <div id="categoriesContainer"></div>
</div>

<!-- Preview Modal -->
<div id="previewModal" class="modal">
  <div class="modal-content small-modal">
    <span class="closeModal" onclick="closePreview()">Ã—</span>
    <img id="previewImg" src="">
    <h3 id="previewTitle"></h3>
    <p id="previewDesc"></p>
    <div class="price" id="previewPrice"></div>
    <button class="btn-neon" id="addToCartBtn">Add to Cart</button>
  </div>
</div>

<!-- Cart Modal -->
<div id="cartModal" class="modal">
  <div class="modal-content small-modal">
    <span class="closeModal" onclick="closeCart()">Ã—</span>
    <h3>Shopping Cart</h3>
    <div class="cart-items" id="cartItems"></div>
    <div class="cart-totals">
      <strong>Total:</strong>
      <span id="cartTotal">Ksh 0</span>
    </div>
    <button class="btn-neon w-full mt-3" onclick="openCheckout()">Proceed to Checkout</button>
  </div>
</div>

<!-- Checkout Modal -->
<div id="checkoutModal" class="modal">
  <div class="modal-content small-modal">
    <span class="closeModal" onclick="closeCheckout()">Ã—</span>
    <h3>Checkout</h3>
    <div style="margin-bottom:1rem;">
      <input type="text" id="checkoutName" placeholder="Full Name" class="btn-outline w-full mb-2">
      <input type="tel" id="checkoutPhone" placeholder="Phone Number" class="btn-outline w-full mb-2">
      <input type="email" id="checkoutEmail" placeholder="Email" class="btn-outline w-full mb-2">
    </div>
    <div id="checkoutProducts" class="cart-items"></div>
    <div class="cart-totals">
      <strong>Total:</strong>
      <span id="checkoutTotal">Ksh 0</span>
    </div>
    <button id="submitOrderBtn" class="btn-neon w-full mt-3" onclick="submitCheckout()">Submit Order</button>
  </div>
</div>

<script>
// ================== DATA ==================
const categories = ["Electronics","Home & Kitchen","Mobile Accessories","Software Solutions","Services"];
const categoriesContainer = document.getElementById('categoriesContainer');
const filterContainer = document.getElementById('categoryFilter');
const searchInput = document.getElementById('searchInput');
const sortSelect = document.getElementById('sortSelect');

let products = [];
let idCounter=1;
categories.forEach(cat=>{
  for(let i=1;i<=50;i++){
    products.push({
      id:'p'+(idCounter++),
      title:`${cat} Product ${i}`,
      desc:`Description for ${cat} Product ${i}`,
      price:Math.floor(Math.random()*5000)+200,
      img:`https://picsum.photos/300/200?random=${idCounter}`,
      category:cat
    });
  }
});

// ================== CART ==================
let cart = JSON.parse(localStorage.getItem('cart')) || [];
let currentDisplayProducts = [...products];
function saveCart(){ localStorage.setItem('cart', JSON.stringify(cart)); }

// ================== RENDER ==================
function createCard(p){
  const card=document.createElement('div'); card.className='card';
  const img=document.createElement('img'); img.src=p.img; img.alt=p.title;
  const content=document.createElement('div'); content.className='card-content';
  const title=document.createElement('h3'); title.innerText=p.title;
  const desc=document.createElement('p'); desc.innerText=p.desc;
  const price=document.createElement('div'); price.className='price'; price.innerText=`Ksh ${p.price}`;
  content.append(title,desc,price); card.appendChild(img); card.appendChild(content);
  card.addEventListener('click',()=>{ card.style.animation='neonPulse 0.6s ease-in-out';
    card.addEventListener('animationend',()=>{ card.style.animation=''; openPreview(p); }, {once:true});
  });
  return card;
}

function createPagination(container, items){
  const pagination = document.createElement('div'); pagination.className = 'pagination';
  const totalPages = Math.ceil(items.length/10); let currentPage = 1;
  function renderPage(page){
    currentPage = page; const grid = container.querySelector('.grid'); grid.innerHTML = '';
    const start = (page-1)*10; const end = start+10;
    items.slice(start,end).forEach(p=>grid.appendChild(createCard(p)));
    pagination.innerHTML='';
    for(let i=1;i<=totalPages;i++){
      const btn=document.createElement('button'); btn.innerText=i;
      if(i===currentPage) btn.classList.add('active');
      btn.addEventListener('click',()=>renderPage(i));
      pagination.appendChild(btn);
    }
  }
  container.appendChild(pagination); renderPage(1);
}

function renderCategories(filteredProducts){
  categoriesContainer.innerHTML='';

  const allSection = document.createElement('div'); allSection.className='category'; allSection.id='AllProducts';
  const allTitle = document.createElement('h2'); allTitle.innerText='All Products';
  allSection.appendChild(allTitle);
  const allGrid = document.createElement('div'); allGrid.className='grid';
  allSection.appendChild(allGrid);
  categoriesContainer.appendChild(allSection);
  createPagination(allSection, filteredProducts);

  categories.forEach(cat=>{
    const catSection = document.createElement('div'); catSection.className='category'; catSection.id=cat.replace(/\s/g,'');
    const title = document.createElement('h2'); title.innerText=cat; catSection.appendChild(title);
    const grid = document.createElement('div'); grid.className='grid'; catSection.appendChild(grid);
    categoriesContainer.appendChild(catSection);
    const catProducts = filteredProducts.filter(p=>p.category===cat);
    createPagination(catSection, catProducts);
  });

  document.querySelectorAll('.category').forEach(sec => sec.style.display='none');
  document.getElementById('AllProducts').style.display='block';
}

// ================== CATEGORY BUTTONS ==================
filterContainer.innerHTML='';
const allBtn = document.createElement('button'); allBtn.innerText = "All Products"; allBtn.classList.add('active');
allBtn.addEventListener('click',()=>{
  document.querySelectorAll('#categoryFilter button').forEach(b=>b.classList.remove('active')); allBtn.classList.add('active');
  document.querySelectorAll('.category').forEach(sec=>sec.style.display='none');
  document.getElementById('AllProducts').style.display='block';
}); filterContainer.appendChild(allBtn);

categories.forEach(cat=>{
  const btn = document.createElement('button'); btn.innerText=cat;
  btn.addEventListener('click',()=>{
    document.querySelectorAll('#categoryFilter button').forEach(b=>b.classList.remove('active')); btn.classList.add('active');
    document.querySelectorAll('.category').forEach(sec=>sec.style.display='none');
    document.getElementById(cat.replace(/\s/g,'')).style.display='block';
  });
  filterContainer.appendChild(btn);
});

// ================== SEARCH & SORT ==================
searchInput.addEventListener('input',()=>{
  const term = searchInput.value.toLowerCase();
  currentDisplayProducts = products.filter(p=>p.title.toLowerCase().includes(term)||p.desc.toLowerCase().includes(term));
  renderCategories(currentDisplayProducts);
});
sortSelect.addEventListener('change',()=>{
  const val = sortSelect.value;
  if(val==='priceLow') currentDisplayProducts.sort((a,b)=>a.price-b.price);
  else if(val==='priceHigh') currentDisplayProducts.sort((a,b)=>b.price-a.price);
  else if(val==='nameAZ') currentDisplayProducts.sort((a,b)=>a.title.localeCompare(b.title));
  else if(val==='nameZA') currentDisplayProducts.sort((a,b)=>b.title.localeCompare(a.title));
  renderCategories(currentDisplayProducts);
});

// ================== CART MODAL ==================
const cartBtn = document.getElementById('cartBtn');
cartBtn.addEventListener('click',()=>openCart());

function openCart(){ document.getElementById('cartModal').style.display='flex'; updateCartUI(); }
function closeCart(){ document.getElementById('cartModal').style.display='none'; }

function updateCartUI(){
  const cartItemsDiv = document.getElementById('cartItems'); cartItemsDiv.innerHTML='';
  if(cart.length===0){ cartItemsDiv.innerHTML='<div class="cart-empty">Your cart is empty.</div>'; }
  cart.forEach(item=>{
    const div = document.createElement('div'); div.className='cart-item';
    const img = document.createElement('img'); img.src=item.img;
    const meta = document.createElement('div'); meta.className='meta';
    meta.innerHTML=`<strong>${item.title}</strong><br>Ksh ${item.price} x ${item.qty}`;
    const qty = document.createElement('div'); qty.className='qty-controls';
    const minus = document.createElement('button'); minus.innerText='-';
    minus.addEventListener('click',()=>{ item.qty--; if(item.qty<=0){ cart=cart.filter(c=>c.id!==item.id);} saveCart(); updateCartUI(); });
    const plus = document.createElement('button'); plus.innerText='+';
    plus.addEventListener('click',()=>{ item.qty++; saveCart(); updateCartUI(); });
    qty.append(minus, plus); div.append(img,meta,qty); cartItemsDiv.appendChild(div);
  });
  const total = cart.reduce((a,b)=>a+b.price*b.qty,0);
  document.getElementById('cartTotal').innerText=`Ksh ${total}`;
  document.getElementById('cartCount').innerText=cart.reduce((a,b)=>a+b.qty,0);
  saveCart();
}

// ================== PREVIEW MODAL ==================
function openPreview(p){
  document.getElementById('previewModal').style.display='flex';
  document.getElementById('previewImg').src=p.img;
  document.getElementById('previewTitle').innerText=p.title;
  document.getElementById('previewDesc').innerText=p.desc;
  document.getElementById('previewPrice').innerText=`Ksh ${p.price}`;
  document.getElementById('addToCartBtn').onclick=()=>{
    const existing = cart.find(c=>c.id===p.id);
    if(existing){ existing.qty++; } else{ cart.push({...p,qty:1}); }
    saveCart(); updateCartUI(); alert(`${p.title} added to cart!`);
  };
}
function closePreview(){ document.getElementById('previewModal').style.display='none'; }

// ================== CHECKOUT MODAL ==================
function openCheckout(){
  if(cart.length===0){ alert('Your cart is empty.'); return; }
  document.getElementById('checkoutModal').style.display='flex';
  const checkoutProductsDiv = document.getElementById('checkoutProducts'); checkoutProductsDiv.innerHTML='';
  cart.forEach(item=>{
    const div = document.createElement('div'); div.className='cart-item';
    const img = document.createElement('img'); img.src=item.img;
    const meta = document.createElement('div'); meta.className='meta';
    meta.innerHTML=`<strong>${item.title}</strong><br>Ksh ${item.price} x ${item.qty}`;
    div.append(img,meta); checkoutProductsDiv.appendChild(div);
  });
  const total = cart.reduce((a,b)=>a+b.price*b.qty,0);
  document.getElementById('checkoutTotal').innerText=`Ksh ${total}`;
}
function closeCheckout(){ document.getElementById('checkoutModal').style.display='none'; }

// ================== EMAIL CHECKOUT ==================
emailjs.init("Iz22KBRfL682WD6td"); // <-- Replace with your EmailJS public key

async function submitCheckout(){
  const submitBtn = document.getElementById('submitOrderBtn');
  const name = document.getElementById('checkoutName').value.trim();
  const phone = document.getElementById('checkoutPhone').value.trim();
  const email = document.getElementById('checkoutEmail').value.trim();
  if(!name || !phone || !email){
    alert('Please fill in all your details.');
    return;
  }
  if(!cart || cart.length === 0){
    alert('Your cart is empty.');
    return;
  }

  const productsSummary = cart.map(i => `${i.title} (Ksh ${i.price} x ${i.qty})`).join('\n');
  const totalAmount = cart.reduce((a,b)=>a+b.price*b.qty,0);

  const adminParams = {
    from_name: name,
    from_phone: phone,
    from_email: email,
    products: productsSummary,
    total: `Ksh ${totalAmount}`
  };

  const customerParams = {
    from_name: name,
    from_email: email,
    products: productsSummary,
    total: totalAmount
  };

  submitBtn.disabled = true;
  submitBtn.innerText = 'Sending...';

  try {
    await emailjs.send('cynic_service', 'template_d145jij', adminParams);
    await emailjs.send('cynic_service', 'template_2b1djar', customerParams);
    alert(`Thank you ${name}! Your order of Ksh ${totalAmount} has been submitted. Check your email for confirmation.`);
    cart = [];
    updateCartUI();
    closeCheckout();
    closeCart();
  } catch (err) {
    console.error('EmailJS send failed:', err);
    let message = 'Sorry, we could not submit your order at this time. Please try again later.';
    if (err && err.text) message += '\n\nDetails: ' + err.text;
    if (err && err.message) message += '\n\nError: ' + err.message;
    alert(message);
  } finally {
    submitBtn.disabled = false;
    submitBtn.innerText = 'Submit Order';
  }
}

// ================== INIT ==================
renderCategories(currentDisplayProducts);
updateCartUI();
</script>
</body>
</html>
